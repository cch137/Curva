import{aM as de,q as z,aX as G,aN as $,az as fe,r as w,H as pe,j as H,ak as me,w as I,u,P as V,I as J,f as Te,b as Fe,l as ye,m as be,o as _,s as ge,t as A,v as T,c as U,y as K,C as X,aY as Q,G as Z,E as ee,A as te,F as se,ap as ke,K as Ce}from"./entry.0a8831f3.js";import{i as _e}from"./el-input.6b481934.js";import{a as he}from"./el-button.eb84f1a6.js";const xe=e=>["",...de].includes(e);let F=[];const ne=e=>{const s=e;s.key===fe.esc&&F.forEach(n=>n(s))},Se=e=>{z(()=>{F.length===0&&document.addEventListener("keydown",ne),G&&F.push(e)}),$(()=>{F=F.filter(s=>s!==e),F.length===0&&G&&document.removeEventListener("keydown",ne)})},B="focus-trap.focus-after-trapped",D="focus-trap.focus-after-released",Pe="focus-trap.focusout-prevented",oe={cancelable:!0,bubbles:!1},we={cancelable:!0,bubbles:!1},ae="focusAfterTrapped",ce="focusAfterReleased",Le=Symbol("elFocusTrap"),M=w(),L=w(0),j=w(0);let h=0;const ve=e=>{const s=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const a=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||a?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)s.push(n.currentNode);return s},re=(e,s)=>{for(const n of e)if(!Oe(n,s))return n},Oe=(e,s)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(s&&e===s)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Ne=e=>{const s=ve(e),n=re(s,e),o=re(s.reverse(),e);return[n,o]},Re=e=>e instanceof HTMLInputElement&&"select"in e,E=(e,s)=>{if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),j.value=window.performance.now(),e!==n&&Re(e)&&s&&e.select()}};function ue(e,s){const n=[...e],o=e.indexOf(s);return o!==-1&&n.splice(o,1),n}const Ie=()=>{let e=[];return{push:o=>{const a=e[0];a&&o!==a&&a.pause(),e=ue(e,o),e.unshift(o)},remove:o=>{var a,i;e=ue(e,o),(i=(a=e[0])==null?void 0:a.resume)==null||i.call(a)}}},Ae=(e,s=!1)=>{const n=document.activeElement;for(const o of e)if(E(o,s),document.activeElement!==n)return},ie=Ie(),Ue=()=>L.value>j.value,S=()=>{M.value="pointer",L.value=window.performance.now()},le=()=>{M.value="keyboard",L.value=window.performance.now()},Ke=()=>(z(()=>{h===0&&(document.addEventListener("mousedown",S),document.addEventListener("touchstart",S),document.addEventListener("keydown",le)),h++}),$(()=>{h--,h<=0&&(document.removeEventListener("mousedown",S),document.removeEventListener("touchstart",S),document.removeEventListener("keydown",le))}),{focusReason:M,lastUserFocusTimestamp:L,lastAutomatedFocusTimestamp:j}),P=e=>new CustomEvent(Pe,{...we,detail:e}),Be=H({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ae,ce,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:s}){const n=w();let o,a;const{focusReason:i}=Ke();Se(t=>{e.trapped&&!p.paused&&s("release-requested",t)});const p={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},m=t=>{if(!e.loop&&!e.trapped||p.paused)return;const{key:c,altKey:l,ctrlKey:d,metaKey:f,currentTarget:W,shiftKey:Y}=t,{loop:x}=e,Ee=c===fe.tab&&!l&&!d&&!f,C=document.activeElement;if(Ee&&C){const O=W,[N,R]=Ne(O);if(N&&R){if(!Y&&C===R){const v=P({focusReason:i.value});s("focusout-prevented",v),v.defaultPrevented||(t.preventDefault(),x&&E(N,!0))}else if(Y&&[N,O].includes(C)){const v=P({focusReason:i.value});s("focusout-prevented",v),v.defaultPrevented||(t.preventDefault(),x&&E(R,!0))}}else if(C===O){const v=P({focusReason:i.value});s("focusout-prevented",v),v.defaultPrevented||t.preventDefault()}}};me(Le,{focusTrapRef:n,onKeydown:m}),I(()=>e.focusTrapEl,t=>{t&&(n.value=t)},{immediate:!0}),I([n],([t],[c])=>{t&&(t.addEventListener("keydown",m),t.addEventListener("focusin",b),t.addEventListener("focusout",g)),c&&(c.removeEventListener("keydown",m),c.removeEventListener("focusin",b),c.removeEventListener("focusout",g))});const r=t=>{s(ae,t)},y=t=>s(ce,t),b=t=>{const c=u(n);if(!c)return;const l=t.target,d=t.relatedTarget,f=l&&c.contains(l);e.trapped||d&&c.contains(d)||(o=d),f&&s("focusin",t),!p.paused&&e.trapped&&(f?a=l:E(a,!0))},g=t=>{const c=u(n);if(!(p.paused||!c))if(e.trapped){const l=t.relatedTarget;!_e(l)&&!c.contains(l)&&setTimeout(()=>{if(!p.paused&&e.trapped){const d=P({focusReason:i.value});s("focusout-prevented",d),d.defaultPrevented||E(a,!0)}},0)}else{const l=t.target;l&&c.contains(l)||s("focusout",t)}};async function k(){await J();const t=u(n);if(t){ie.push(p);const c=t.contains(document.activeElement)?o:document.activeElement;if(o=c,!t.contains(c)){const d=new Event(B,oe);t.addEventListener(B,r),t.dispatchEvent(d),d.defaultPrevented||J(()=>{let f=e.focusStartEl;Te(f)||(E(f),document.activeElement!==f&&(f="first")),f==="first"&&Ae(ve(t),!0),(document.activeElement===c||f==="container")&&E(t)})}}}function q(){const t=u(n);if(t){t.removeEventListener(B,r);const c=new CustomEvent(D,{...oe,detail:{focusReason:i.value}});t.addEventListener(D,y),t.dispatchEvent(c),!c.defaultPrevented&&(i.value=="keyboard"||!Ue()||t.contains(document.activeElement))&&E(o??document.body),t.removeEventListener(D,r),ie.remove(p)}}return z(()=>{e.trapped&&k(),I(()=>e.trapped,t=>{t?k():q()})}),$(()=>{e.trapped&&q()}),{onKeydown:m}}});function De(e,s,n,o,a,i){return V(e.$slots,"default",{handleKeydown:e.onKeydown})}var Ge=pe(Be,[["render",De],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const Ve=Fe({type:{type:String,values:["success","info","warning","danger",""],default:""},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:{type:String,default:""},size:{type:String,values:de,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),ze={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},$e=H({name:"ElTag"}),He=H({...$e,props:Ve,emits:ze,setup(e,{emit:s}){const n=e,o=he(),a=ye("tag"),i=be(()=>{const{type:r,hit:y,effect:b,closable:g,round:k}=n;return[a.b(),a.is("closable",g),a.m(r),a.m(o.value),a.m(b),a.is("hit",y),a.is("round",k)]}),p=r=>{s("close",r)},m=r=>{s("click",r)};return(r,y)=>r.disableTransitions?(_(),ge("span",{key:0,class:T(u(i)),style:se({backgroundColor:r.color}),onClick:m},[A("span",{class:T(u(a).e("content"))},[V(r.$slots,"default")],2),r.closable?(_(),U(u(ee),{key:0,class:T(u(a).e("close")),onClick:Z(p,["stop"])},{default:K(()=>[X(u(Q))]),_:1},8,["class","onClick"])):te("v-if",!0)],6)):(_(),U(ke,{key:1,name:`${u(a).namespace.value}-zoom-in-center`,appear:""},{default:K(()=>[A("span",{class:T(u(i)),style:se({backgroundColor:r.color}),onClick:m},[A("span",{class:T(u(a).e("content"))},[V(r.$slots,"default")],2),r.closable?(_(),U(u(ee),{key:0,class:T(u(a).e("close")),onClick:Z(p,["stop"])},{default:K(()=>[X(u(Q))]),_:1},8,["class","onClick"])):te("v-if",!0)],6)]),_:3},8,["name"]))}});var Me=pe(He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]]);const Je=Ce(Me);export{Je as E,Le as F,Ge as a,xe as i,Ve as t};
